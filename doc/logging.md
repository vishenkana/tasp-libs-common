# Логирование

[[_TOC_]]

## Общие сведения

Вывод информации происходит в асинхронном режиме. Информация накапливается в
очереди и по таймауту выводится в лог.

Поддерживается логирование в:

- syslog
- файл
- консольный вывод

Настройка параметров логирования производится с помощью конфигурационного файла.
Структура параметров в конфигурационном файле:

```yaml
logging:
  ОБЩИЕ_ПАРМЕТРЫ

  sinks:
    НАЗВАНИЕ_ТИПА:
      ПАРМЕТРЫ_ТИПА
```

### Общие параметры логирования

- timeout - таймаут вывода информации в лог.

## Типы вывода

Общие параметры каждого типа:

- enable - включение/выключение логирования
- level - максимальный уровень сообщения для вывода, поддерживаемые уровни:
  - debug
  - info
  - warning
  - error

### Syslog

Вывод информации в syslog. Выводится только текст сообщения.

Дополнительных параметров нет.

### Файл

Вывод информации текстовый файл. Вывод осуществляется в формате:

[ВРЕМЯ] [НАЗВАНИЕ_ФАЙЛА] [СТРОКА] [НОМЕР_ПОТОКА] [УРОВЕНЬ] [СООБЩЕНИЕ]

Поддерживается ротация логов. К имени файла добавляется ".НОМЕР_ФАЙЛА".

Параметры:

- path - путь к директории с логами
- name - название файла лога
- rotate - подпункт ротации логов
  - enable - включение/выключение ротации
  - max_size - максимальный размер файла
  - max_files - максимальное количество файлов

### Консольный вывод

Вывод информации в консоль. При уровне **debug** вывод осуществляется в stderr,
при остальных уровнях в stdout. Выводится только текст сообщения.

Дополнительных параметров нет.

## Пример

```yaml
logging:
  timeout: 10

  sinks:
    syslog:
      enable: true
      level: debug

    file:
      enable: true
      level: debug
      path: /var/spo/niitp/tasp/log
      name: repo.log
      rotate:
        enable: true
        max_size: 10
        max_files: 10

    console:
      enable: true
      level: debug
```
